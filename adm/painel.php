<?phpob_start();session_start();require('../_app/Config.inc.php');$Adm = [3, 4];$Coord = [6];$Ceo = [2];$login = new Login($Adm);$n = new Check;$logoff = filter_input(INPUT_GET, 'logoff', FILTER_VALIDATE_BOOLEAN);$getexe = filter_input(INPUT_GET, 'exe', FILTER_DEFAULT);if (!$login->CheckLogin()):    unset($_SESSION['userlogin']);    header('Location: index.php?exe=restrito');    exit;else:    $userlogin = $_SESSION['userlogin'];    $Adm = (in_array($userlogin['nivel_user'], $Adm));    $Ceo = (in_array($userlogin['nivel_user'], $Ceo));    $Coord = (in_array($userlogin['nivel_user'], $Coord));endif;if ($logoff):    unset($_SESSION['userlogin']);    header('Location: index.php?exe=logoff');    exit;endif;$Read = new Read();$Read->FullRead("SELECT * FROM tb_tickets WHERE status = 'PENDENTE' ORDER BY id DESC LIMIT 1");?><!DOCTYPE html><html>    <head>        <meta charset="UTF-8">        <title class="title_p">Painel</title>        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet"/>        <link rel="stylesheet" href="css/linearicons/web-font.css"/>                <link rel="stylesheet" href="css/admin.css"/>        <link rel="stylesheet" href="css/datatable/bootstrap4.css"/>        <link rel="stylesheet" href="css/datatable/datatables.bootstrap4.css"/>        <link rel="stylesheet" href="https://cdn.datatables.net/rowgroup/1.0.4/css/rowGroup.bootstrap4.min.css"/>        <link rel="shortcut icon" type="image/png" href="https://wsmtec.com.br/themes/wsm/images/flavicon.png">        <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />    </head>    <body data-tic="<?= empty($Read->getResult()[0]['id']) ? 0 : $Read->getResult()[0]['id']; ?>" id="<?= ($n->Name($getexe) ? $n->Name($getexe) : 'painel'); ?>" data-dash="<?= ($Adm ? 'sede' : 'escritorio'); ?>">        <?php        require('inc/header.inc.php');        //QUERY STRING        if (!empty($getexe)):            $includepatch = __DIR__ . DIRECTORY_SEPARATOR . 'system' . DIRECTORY_SEPARATOR . strip_tags(trim($getexe) . '.php');        else:            $includepatch = __DIR__ . DIRECTORY_SEPARATOR . 'system' . DIRECTORY_SEPARATOR . 'home.php';        endif;        if (file_exists($includepatch)):            require_once($includepatch);        else:            echo "<div class=\"content notfound\">";            WSErro("<b>Erro ao incluir tela:</b> Erro ao incluir o controller /{$getexe}.php!", WS_ERROR);            echo "</div>";        endif;        require('inc/footer.inc.php');        ?>        <!--MODAL-->        <div class="modal-form">            <div class="modal-box">                <div class="modal-all">                    <div class="header-modal-box">                        <h4></h4>                        <div class="close"><span class="lnr lnr-cross"></span></div>                    </div>                    <div class="row-body">                    </div>                </div>            </div>        </div>        <div class="modal">            <div class="modal-box">                <div class="modal-all">                    <div class="header-modal-box">                        <h4></h4>                        <div class="close"><span class="lnr lnr-cross"></span></div>                    </div>                    <div class="body-box">                    </div>                    <div class="footer-box">                    </div>                </div>            </div>        </div>        <div class="modal-function">            <div class="modal-box">                <div class="modal-all">                    <div class="header-modal-box">                        <h4></h4>                        <div class="close"><span class="lnr lnr-cross"></span></div>                    </div>                    <div class="row-f">                        <label></label>                    </div>                    <div class="footer-box">                        <div class="footer-btn">                            <a class="btn-accept btn-default btn-success btn-all" data-bolean="1" ><span class="lnr lnr-trash"></span> Confirmar</a>                            <a class="btn-cancel btn-default btn-clean btn-rigth"><span class="lnr lnr-cross-circle"></span> Cancelar</a>                        </div>                    </div>                </div>            </div>        </div>        <!--SCRIPTS-->        <script src="__jsc/jquery.js" type="text/javascript"></script>        <script src="__jsc/jquery-form.js" type="text/javascript"></script>        <script src="__jsc/jquery.worked-hours-grid.min.js" type="text/javascript"></script>        <script src="__jsc/ajax.js" type="text/javascript"></script>        <script src="__jsc/script.js" type="text/javascript"></script>        <script>            document.addEventListener('DOMContentLoaded', function () {                if (Notification.permission !== 'granted')                    Notification.requestPermission();            });            function notifyMe(icon, title, mensagem, link) {                if (!Notification) {                    alert('O navegador que você está utilizando não possui o notifications. Tente o Chrome');                    return;                }                if (Notification.permission !== "granted") {                    Notification.requestPermission();                } else {                    var notification = new Notification(title, {                        icon: icon,                        body: mensagem                    });                    notification.onclick = function () {                        window.open(link);                    };                }            }//            function play() {//            var audio = new Audio(//                    'https://www.wsmtec.com.br/adm/sons/c.wav');//            audio.play();//            }//            notifyMe(//                    "https://www.wsmtec.com.br/themes/wsm/images/logo/logo_push.jpg",//                    "WSMTEC",//                    "Click the button below to show a notification. They appear different in different browsers.",//                    "https://www.wsmtec.com.br/adm/painel.php?exe=tickets/index"//                    );        </script>        <?php if ($Adm || $Coord): ?>            <script>                setInterval(function () {                    //                    var lastId = $('body').data("tic");                    var lastIds = $('body').map(function () {                        return $('body').attr('data-tic');                    }).get();                    var lastIdss = Math.max.apply(null, lastIds);                    console.log(lastIdss);                    $.post('_models/AdminManager.php?action=search-ticket-msg-push-adm', {codigo: lastIdss}, function (data) {                        if (data.tic_n) {                            $('.title_p').html('(' + data.tic_n + ') Painel');                        } else {                            $('.title_p').html('Painel');                        }                        if (data.tic_m) {                            var audio = new Audio(                                    'https://www.wsmtec.com.br/adm/sons/a.mp3');                            audio.play();                            notifyMe(                                    "https://www.wsmtec.com.br/themes/wsm/images/logo/logo_push.jpg",                                    "WSMTEC",                                    data.tic_m,                                    "https://www.wsmtec.com.br/adm/painel.php?exe=tickets/index"                                    );                            $('body').attr('data-tic', data.tic_i);                        }                    }, 'json');                }, 90000);            </script>        <?php endif; ?>        <?php if ($Adm): ?>            <!--                        <script>                setInterval(function () {                    $.post('_models/AdminManager.php?action=search-ticket-msg-push-adm', {codigo: <?= $userlogin['IdUsuario']; ?>}, function (data) {                        if (data) {                            notifyMe(                                    "https://www.wsmtec.com.br/themes/wsm/images/logo/logo_push.png",                                    "WSMTEC",                                    data.mensagem,                                    "https://www.wsmtec.com.br/adm/painel.php?exe=tickets/room&ticket=" + data.idticket                                    );                        }                    }, 'json');                }, 4000);            </script>            -->        <?php endif; ?>        <?php if (!$Adm): ?>            <!--                    <script>                setInterval(function () {                    $.post('_models/AdminManager.php?action=search-ticket-msg-push', {codigo: <?= $userlogin['IdUsuario']; ?>}, function (data) {                        if (data) {                            notifyMe(                                    "https://www.wsmtec.com.br/themes/wsm/images/logo/logo_push.png",                                    "WSMTEC",                                    data.mensagem,                                    "https://www.wsmtec.com.br/adm/painel.php?exe=tickets/room&ticket=" + data.idticket                                    );                        }                    }, 'json');                }, 4000);            </script>            -->        <?php endif; ?>        <!--                <script>            function pushUser() {                setInterval(function () {                    $.post('_models/AdminManager.php?action=search-ticket-msg-pushs', {codigo: <?= $userlogin['IdUsuario']; ?>}, function (data) {                        if (data) {                            notifyMe(                                    "https://www.wsmtec.com.br/themes/wsm/images/logo/logo_push.png",                                    "WSMTEC",                                    data.mensagem,                                    "https://www.wsmtec.com.br/adm/painel.php?exe=tickets/room&ticket=" + data.idticket                                    );                        }                    }, 'json');                }, 9000);            }        </script>        -->        <script src="__jsc/datatable/datatable.js" type="text/javascript"></script>        <script src="__jsc/datatable/dataTables.rowGroup.min.js" type="text/javascript"></script>        <script src="__jsc/datatable/datatable.bootstrap4.js" type="text/javascript"></script>        <script src="__jsc/amcharts/amcharts.js"></script>        <script src="__jsc/amcharts/lang/pt.js"></script>        <script src="__jsc/amcharts/plugins/dataloader/dataloader.min.js"></script>        <script src="__jsc/amcharts/pie.js"></script>        <script src="__jsc/amcharts/serial.js"></script>        <script src="__jsc/amcharts/plugins/export/export.min.js"></script>        <script src="__jsc/amcharts/plugins/export/lang/pt.js"></script>        <script src="__jsc/amcharts/themes/light.js"></script>        <!--<script src="__jsc/amcharts/plugins/animate/animate.min.js"></script>-->        <!--<script src="__jsc/amcharts/plugins/responsive/responsive.min.js"></script>-->        <script src="__jsc/script-chart.js" type="text/javascript"></script>         <script src="__jsc/tinymce/tinymce.min.js"></script>        <script type="text/javascript">//            tinymce.activeEditor.formatter.remove('custom_format');                tinymce.init({                    selector: '.js_editor',                    language: 'pt_BR',                    force_br_newlines: true,                    force_p_newlines: false,                    forced_root_block: '',//                br_in_pre: false,                    theme: 'modern',                    menu: {},                    plugins: 'print preview searchreplace autolink directionality visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount imagetools contextmenu colorpicker textpattern help',                    toolbar1: 'formatselect | bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat',                    image_advtab: true,                    content_css: [                        '//fonts.googleapis.com/css?family=Lato:300,300i,400,400i',                        '//www.tinymce.com/css/codepen.min.css'                    ]                });//            plugins: 'print preview fullpage powerpaste searchreplace autolink directionality advcode visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount tinymcespellchecker a11ychecker imagetools mediaembed  linkchecker contextmenu colorpicker textpattern help',//            toolbar1: 'formatselect | bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat',        </script>    </body></html>